<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>AMApplicationBuild</key>
	<string>444.42</string>
	<key>AMApplicationVersion</key>
	<string>2.9</string>
	<key>AMDocumentVersion</key>
	<string>2</string>
	<key>actions</key>
	<array>
		<dict>
			<key>action</key>
			<dict>
				<key>AMAccepts</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Optional</key>
					<false/>
					<key>Types</key>
					<array>
						<string>*</string>
					</array>
				</dict>
				<key>AMActionVersion</key>
				<string>v.1.0.2</string>
				<key>AMApplication</key>
				<array>
					<string>自动操作</string>
				</array>
				<key>AMParameterProperties</key>
				<dict>
					<key>variableUUID</key>
					<dict>
						<key>isPathPopUp</key>
						<false/>
						<key>selectedVariableUUID</key>
						<string>3829AC00-FCBA-4A4C-9207-F103344DE268</string>
						<key>variableUUIDsInMenu</key>
						<array/>
					</dict>
				</dict>
				<key>AMProvides</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Types</key>
					<array>
						<string>*</string>
					</array>
				</dict>
				<key>AMRequiredResources</key>
				<array/>
				<key>ActionBundlePath</key>
				<string>/System/Library/Automator/Set Value of Variable.action</string>
				<key>ActionName</key>
				<string>设定变量的值</string>
				<key>ActionParameters</key>
				<dict>
					<key>variableUUID</key>
					<string>3829AC00-FCBA-4A4C-9207-F103344DE268</string>
				</dict>
				<key>BundleIdentifier</key>
				<string>com.apple.Automator.SetValueofVariable</string>
				<key>CFBundleVersion</key>
				<string>1.0.2</string>
				<key>CanShowSelectedItemsWhenRun</key>
				<true/>
				<key>CanShowWhenRun</key>
				<true/>
				<key>Category</key>
				<array>
					<string>AMCategoryUtilities</string>
				</array>
				<key>Class Name</key>
				<string>Set_Value_of_Variable</string>
				<key>InputUUID</key>
				<string>4C1C933B-18A5-459C-AF12-A8936DA149D9</string>
				<key>Keywords</key>
				<array>
					<string>变量</string>
					<string>绑定</string>
					<string>输入</string>
					<string>输出</string>
					<string>储存</string>
				</array>
				<key>OutputUUID</key>
				<string>15BDD8F7-F9F7-4CBE-AA6D-80BE8350D24E</string>
				<key>UUID</key>
				<string>0C322224-079C-40B2-827A-697595EFD823</string>
				<key>UnlocalizedApplications</key>
				<array>
					<string>Automator</string>
				</array>
				<key>arguments</key>
				<dict>
					<key>0</key>
					<dict>
						<key>default value</key>
						<string></string>
						<key>name</key>
						<string>variableUUID</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>0</string>
					</dict>
				</dict>
				<key>isViewVisible</key>
				<true/>
				<key>location</key>
				<string>374.500000:228.000000</string>
				<key>nibPath</key>
				<string>/System/Library/Automator/Set Value of Variable.action/Contents/Resources/Base.lproj/main.nib</string>
			</dict>
			<key>isViewVisible</key>
			<true/>
		</dict>
		<dict>
			<key>action</key>
			<dict>
				<key>AMAccepts</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Optional</key>
					<true/>
					<key>Types</key>
					<array>
						<string>com.apple.applescript.object</string>
					</array>
				</dict>
				<key>AMActionVersion</key>
				<string>1.0.2</string>
				<key>AMApplication</key>
				<array>
					<string>自动操作</string>
				</array>
				<key>AMParameterProperties</key>
				<dict>
					<key>source</key>
					<dict/>
				</dict>
				<key>AMProvides</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Types</key>
					<array>
						<string>com.apple.applescript.object</string>
					</array>
				</dict>
				<key>ActionBundlePath</key>
				<string>/System/Library/Automator/Run AppleScript.action</string>
				<key>ActionName</key>
				<string>运行 AppleScript</string>
				<key>ActionParameters</key>
				<dict>
					<key>source</key>
					<string>set theDeviceList to {"转换为PNG", "转换为PNG保留布局", "位图转矢量", "修改尺寸", "修改尺寸并更改格式", "修改画布大小", "修剪图片", "修剪图片从中心", "aspect裁剪图片", "aspect裁剪图片填充", "自动去背", "去除白色", "color2alpha自动", "color2alpha去除白色", "color2alpha去除黑色", "color2alpha自定义", "绿幕抠像", "缩小文件大小", "裁剪为矩形", "裁剪并拉直", "高斯模糊", "水彩效果", "刺绣效果"}set theDevice to (choose from list theDeviceList with prompt "选择操作:" default items {"转换为PNG"} with title "图片处理 by Sengoku")if theDevice is false then	display notification "已取消，若想转换图片请重新运行。" with title "用户取消🙁" sound name "Basso"	error number -128else	item 1 of theDeviceend if</string>
				</dict>
				<key>BundleIdentifier</key>
				<string>com.apple.Automator.RunScript</string>
				<key>CFBundleVersion</key>
				<string>1.0.2</string>
				<key>CanShowSelectedItemsWhenRun</key>
				<false/>
				<key>CanShowWhenRun</key>
				<true/>
				<key>Category</key>
				<array>
					<string>AMCategoryUtilities</string>
				</array>
				<key>Class Name</key>
				<string>RunScriptAction</string>
				<key>IgnoresInput</key>
				<true/>
				<key>InputUUID</key>
				<string>B95C9389-97DF-45B2-94EE-B16BD9C8A9AB</string>
				<key>Keywords</key>
				<array>
					<string>运行</string>
				</array>
				<key>OutputUUID</key>
				<string>308B0939-6B99-4D2F-93ED-FFE5B710299D</string>
				<key>UUID</key>
				<string>FD4028FE-A123-4593-AA98-94F10EAE37A3</string>
				<key>UnlocalizedApplications</key>
				<array>
					<string>Automator</string>
				</array>
				<key>arguments</key>
				<dict>
					<key>0</key>
					<dict>
						<key>default value</key>
						<string>on run {input, parameters}
	
	(* Your script goes here *)
	
	return input
end run</string>
						<key>name</key>
						<string>source</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>0</string>
					</dict>
				</dict>
				<key>isViewVisible</key>
				<true/>
				<key>location</key>
				<string>374.500000:473.000000</string>
				<key>nibPath</key>
				<string>/System/Library/Automator/Run AppleScript.action/Contents/Resources/Base.lproj/main.nib</string>
			</dict>
			<key>isViewVisible</key>
			<true/>
		</dict>
		<dict>
			<key>action</key>
			<dict>
				<key>AMAccepts</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Optional</key>
					<true/>
					<key>Types</key>
					<array>
						<string>com.apple.cocoa.string</string>
					</array>
				</dict>
				<key>AMActionVersion</key>
				<string>2.0.3</string>
				<key>AMApplication</key>
				<array>
					<string>自动操作</string>
				</array>
				<key>AMParameterProperties</key>
				<dict>
					<key>COMMAND_STRING</key>
					<dict/>
					<key>CheckedForUserDefaultShell</key>
					<dict/>
					<key>inputMethod</key>
					<dict/>
					<key>shell</key>
					<dict/>
					<key>source</key>
					<dict/>
				</dict>
				<key>AMProvides</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Types</key>
					<array>
						<string>com.apple.cocoa.string</string>
					</array>
				</dict>
				<key>ActionBundlePath</key>
				<string>/System/Library/Automator/Run Shell Script.action</string>
				<key>ActionName</key>
				<string>运行 Shell 脚本</string>
				<key>ActionParameters</key>
				<dict>
					<key>COMMAND_STRING</key>
					<string># 缓存地址
config=~/Library/Caches/image_config

echo "$1" &gt; $config
</string>
					<key>CheckedForUserDefaultShell</key>
					<true/>
					<key>inputMethod</key>
					<integer>1</integer>
					<key>shell</key>
					<string>/bin/bash</string>
					<key>source</key>
					<string></string>
				</dict>
				<key>BundleIdentifier</key>
				<string>com.apple.RunShellScript</string>
				<key>CFBundleVersion</key>
				<string>2.0.3</string>
				<key>CanShowSelectedItemsWhenRun</key>
				<false/>
				<key>CanShowWhenRun</key>
				<true/>
				<key>Category</key>
				<array>
					<string>AMCategoryUtilities</string>
				</array>
				<key>Class Name</key>
				<string>RunShellScriptAction</string>
				<key>Disabled</key>
				<false/>
				<key>InputUUID</key>
				<string>4D64E890-DE34-47ED-AD7D-8022BE2F9EF1</string>
				<key>Keywords</key>
				<array>
					<string>Shell</string>
					<string>脚本</string>
					<string>命令</string>
					<string>运行</string>
					<string>Unix</string>
				</array>
				<key>OutputUUID</key>
				<string>CC78BB5B-16AD-4838-807F-1C58B740858B</string>
				<key>UUID</key>
				<string>98C08AC0-5661-43FB-A783-4EDEEA4DEFE8</string>
				<key>UnlocalizedApplications</key>
				<array>
					<string>Automator</string>
				</array>
				<key>arguments</key>
				<dict>
					<key>0</key>
					<dict>
						<key>default value</key>
						<integer>0</integer>
						<key>name</key>
						<string>inputMethod</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>0</string>
					</dict>
					<key>1</key>
					<dict>
						<key>default value</key>
						<string></string>
						<key>name</key>
						<string>source</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>1</string>
					</dict>
					<key>2</key>
					<dict>
						<key>default value</key>
						<false/>
						<key>name</key>
						<string>CheckedForUserDefaultShell</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>2</string>
					</dict>
					<key>3</key>
					<dict>
						<key>default value</key>
						<string></string>
						<key>name</key>
						<string>COMMAND_STRING</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>3</string>
					</dict>
					<key>4</key>
					<dict>
						<key>default value</key>
						<string>/bin/sh</string>
						<key>name</key>
						<string>shell</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>4</string>
					</dict>
				</dict>
				<key>isViewVisible</key>
				<true/>
				<key>location</key>
				<string>374.500000:655.000000</string>
				<key>nibPath</key>
				<string>/System/Library/Automator/Run Shell Script.action/Contents/Resources/Base.lproj/main.nib</string>
			</dict>
			<key>isViewVisible</key>
			<true/>
		</dict>
		<dict>
			<key>action</key>
			<dict>
				<key>AMAccepts</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Optional</key>
					<true/>
					<key>Types</key>
					<array>
						<string>*</string>
					</array>
				</dict>
				<key>AMActionVersion</key>
				<string>v.1.0.2</string>
				<key>AMApplication</key>
				<array>
					<string>自动操作</string>
				</array>
				<key>AMParameterProperties</key>
				<dict>
					<key>variableUUID</key>
					<dict>
						<key>isPathPopUp</key>
						<false/>
						<key>selectedVariableUUID</key>
						<string>3829AC00-FCBA-4A4C-9207-F103344DE268</string>
						<key>variableUUIDsInMenu</key>
						<array/>
					</dict>
				</dict>
				<key>AMProvides</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Types</key>
					<array>
						<string>*</string>
					</array>
				</dict>
				<key>AMRequiredResources</key>
				<array/>
				<key>ActionBundlePath</key>
				<string>/System/Library/Automator/Get Value of Variable.action</string>
				<key>ActionName</key>
				<string>获得变量的值</string>
				<key>ActionParameters</key>
				<dict>
					<key>variableUUID</key>
					<string>3829AC00-FCBA-4A4C-9207-F103344DE268</string>
				</dict>
				<key>BundleIdentifier</key>
				<string>com.apple.Automator.GetValueofVariable</string>
				<key>CFBundleVersion</key>
				<string>1.0.2</string>
				<key>CanShowSelectedItemsWhenRun</key>
				<false/>
				<key>CanShowWhenRun</key>
				<true/>
				<key>Category</key>
				<array>
					<string>AMCategoryUtilities</string>
				</array>
				<key>Class Name</key>
				<string>Get_Value_of_Variable</string>
				<key>Disabled</key>
				<false/>
				<key>IgnoresInput</key>
				<true/>
				<key>InputUUID</key>
				<string>089335AB-77CC-44FD-BA95-6CE3003ECA21</string>
				<key>Keywords</key>
				<array>
					<string>变量</string>
					<string>绑定</string>
					<string>输入</string>
					<string>输出</string>
					<string>储存</string>
				</array>
				<key>OutputUUID</key>
				<string>DF1F79AB-2F01-4A64-87EA-3F763D3419C3</string>
				<key>UUID</key>
				<string>1B28246C-46B3-4668-80AB-C709673915C7</string>
				<key>UnlocalizedApplications</key>
				<array>
					<string>Automator</string>
				</array>
				<key>arguments</key>
				<dict>
					<key>0</key>
					<dict>
						<key>default value</key>
						<string></string>
						<key>name</key>
						<string>variableUUID</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>0</string>
					</dict>
				</dict>
				<key>isViewVisible</key>
				<true/>
				<key>location</key>
				<string>374.500000:757.000000</string>
				<key>nibPath</key>
				<string>/System/Library/Automator/Get Value of Variable.action/Contents/Resources/Base.lproj/main.nib</string>
			</dict>
			<key>isViewVisible</key>
			<true/>
		</dict>
		<dict>
			<key>action</key>
			<dict>
				<key>AMAccepts</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Optional</key>
					<true/>
					<key>Types</key>
					<array>
						<string>com.apple.cocoa.string</string>
					</array>
				</dict>
				<key>AMActionVersion</key>
				<string>2.0.3</string>
				<key>AMApplication</key>
				<array>
					<string>自动操作</string>
				</array>
				<key>AMParameterProperties</key>
				<dict>
					<key>COMMAND_STRING</key>
					<dict/>
					<key>CheckedForUserDefaultShell</key>
					<dict/>
					<key>inputMethod</key>
					<dict/>
					<key>shell</key>
					<dict/>
					<key>source</key>
					<dict/>
				</dict>
				<key>AMProvides</key>
				<dict>
					<key>Container</key>
					<string>List</string>
					<key>Types</key>
					<array>
						<string>com.apple.cocoa.string</string>
					</array>
				</dict>
				<key>ActionBundlePath</key>
				<string>/System/Library/Automator/Run Shell Script.action</string>
				<key>ActionName</key>
				<string>运行 Shell 脚本</string>
				<key>ActionParameters</key>
				<dict>
					<key>COMMAND_STRING</key>
					<string>version="图片处理 v1.2.1 by Sengoku"
# 高模糊添加输入参数
# aspect裁剪添加重力模式
# 添加 color2alpha 自动,提取左上角颜色自动抠图
# 修复使用"位图转矢量"时多图层文件错误
# -----------------------------
# 设置环境变量
PATH=$PATH:/usr/local/bin/:~/.imagemagick_scripts
# 设置路径变量
var="$1"
# 缓存地址
config=~/Library/Caches/image_config
# 读取缓存设置
IMAGE_SET=$(&lt;$config)

# 获取文件信息
dir="$(dirname "$var")"
name="$(basename "$var")"
# 定位目录路径
cd "$dir"

# 开始处理
if [ "$IMAGE_SET" = "转换为PNG" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick {} "{.}.png"
fi

if [ "$IMAGE_SET" = "转换为PNG保留布局" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick {} -set dispose Background -coalesce "{.}.png"
fi

if [ "$IMAGE_SET" = "位图转矢量" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus 'magick {}[0] {.}.bmp; potrace {.}.bmp; rm {.}.bmp'
fi

if [ "$IMAGE_SET" = "修改尺寸" ]; then
    # 获取原始图片尺寸
    imageSIZE="$(magick identify -ping -format "%wx%h\n" "$1" | tail -1)"
    # 输入修改尺寸
    imageRESIZE="$(osascript -e 'display dialog "设置尺寸:\n\n 🚩\t50％\t\t\t\t等比缩小50%\n 🚩\t宽度\t\t\t\t\t给定宽度,高度自适应 \n 🚩\tx高度\t\t\t\t给定高度,宽度自适应 \n 🚩\t忽略宽高比 &lt;!&gt; 标志\t强制修改" default answer "'$imageSIZE'" with title "'"$version"'"' -e 'text returned of result' 2&gt;/dev/null)"
    # 若取消则退出，若留空则使用默认值
    if [ $? -ne 0 ]; then
          osascript -e 'display notification "已取消输入，若想转换图片请重新运行。" with title "用户取消🙁" sound name "Basso"'
            exit 0
        elif [ -z "$imageRESIZE" ]; then
      imageRESIZE="$imageSIZE"
        fi
    # 开始转换格式
    find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick {} -resize "$imageRESIZE" "{.}_$imageRESIZE.{+.}"
fi

if [ "$IMAGE_SET" = "修改尺寸并更改格式" ]; then
    # 获取原始图片尺寸
    imageSIZE="$(magick identify -ping -format "%wx%h\n" "$1" | tail -1)"
    # 输入修改尺寸
    imageRESIZE="$(osascript -e 'display dialog "设置尺寸:\n\n 🚩\t此模式默认DPI\t\t300\n 🚩\t50％\t\t\t\t等比缩小50%\n 🚩\t宽度\t\t\t\t\t给定宽度,高度自适应 \n 🚩\tx高度\t\t\t\t给定高度,宽度自适应 \n 🚩\t忽略宽高比 &lt;!&gt; 标志\t强制修改 \n 🚩\t调整矢量图效果比较好" default answer "'$imageSIZE'" with title "'"$version"'"' -e 'text returned of result' 2&gt;/dev/null)"
    # 若取消则退出，若留空则使用默认值
    if [ $? -ne 0 ]; then
          osascript -e 'display notification "已取消输入，若想转换图片请重新运行。" with title "用户取消🙁" sound name "Basso"'
            exit 0
        elif [ -z "$imageRESIZE" ]; then
      imageRESIZE="$imageSIZE"
        fi
    # 输入格式
    imageEXT="$(osascript -e 'display dialog "图片格式:(默认:jpg)" default answer "'jpg'" with title "'"$version"'"' -e 'text returned of result' 2&gt;/dev/null)"
    # 若取消则退出，若留空则使用默认值
    if [ $? -ne 0 ]; then
          osascript -e 'display notification "已取消输入，若想转换图片请重新运行。" with title "用户取消🙁" sound name "Basso"'
            exit 0
        elif [ -z "$imageEXT" ]; then
      imageEXT="jpg"
        fi
    # 开始转换格式
    find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick -density 300 {} -resize "$imageRESIZE" "{.}_'$imageRESIZE'_DPI300.$imageEXT"
fi

if [ "$IMAGE_SET" = "修改画布大小" ]; then
    # 获取原始图片尺寸
    imageSIZE="$(magick identify -ping -format "%wx%h\n" "$1" | tail -1)"
    # 输入画布尺寸
    imageRESIZE="$(osascript -e 'display dialog "设置尺寸:\n\n ◎\t如果图像尺寸增加，将在图像的右边缘或底边缘添加空间\n ◎\t如果减小，则仅将图像进行裁切以适合新的图像大小\n\n 🚩\t50％\t\t\t\t从中心缩小50%\n 🚩\t宽度\t\t\t\t\t给定宽度,高度自适应 \n 🚩\tx高度\t\t\t\t给定高度,宽度自适应 \n 🚩\t宽度x高度-10-10\t\t设置水平垂直偏移量10 &lt;像素&gt;" default answer "'$imageSIZE'" with title "'"$version"'"' -e 'text returned of result' 2&gt;/dev/null)"
    # 若取消则退出，若留空则使用默认值
    if [ $? -ne 0 ]; then
          osascript -e 'display notification "已取消输入，若想转换图片请重新运行。" with title "用户取消🙁" sound name "Basso"'
            exit 0
        elif [ -z "$imageRESIZE" ]; then
      imageRESIZE="$imageSIZE"
        fi
    # 开始转换格式
    find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick {} -gravity center -extent "$imageRESIZE" "{.}_$imageRESIZE.{+.}"
fi

if [ "$IMAGE_SET" = "修剪图片" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick {} -trim "{.}.{+.}"
fi

if [ "$IMAGE_SET" = "修剪图片从中心" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus centertrim -f 1 {} "{.}_centertrim.{+.}"
fi

if [ "$IMAGE_SET" = "aspect裁剪图片" ]; then
      # 获取原始图片尺寸
      imageSIZE="$(magick identify -ping -format "%wx%h\n" "$1" | tail -1)"
      # 输入修改尺寸
      imageRESIZE="$(osascript -e 'display dialog "设置图片尺寸:\t\t模式:裁剪\n\nWidthxHeight\t\t宽度x高度,指定所需的输出大小" default answer "'$imageSIZE'" with title "'"$version"'"' -e 'text returned of result' 2&gt;/dev/null)"
      # 若取消则退出，若留空则使用默认值
      if [ $? -ne 0 ]; then
            osascript -e 'display notification "已取消输入，若想转换图片请重新运行。" with title "用户取消🙁" sound name "Basso"'
              exit 0
          elif [ -z "$imageRESIZE" ]; then
        imageRESIZE="$imageSIZE"
          fi
      imageGRAVITY="$(osascript -e 'tell app "System Events" to return choose from list {"上", "下", "左", "右", "中心"} with prompt "选择裁剪区域的开始边界:\n上,下,左,右,和中心;默认为中心" default items {"中心"} with title "'"$version"'" OK button name {"确定"} cancel button name {"取消"}' 2&gt;/dev/null)"
      # 若取消则退出，若留空则使用默认值
      if [ $? -ne 0 ]; then
            osascript -e 'display notification "已取消输入，若想转换图片请重新运行。" with title "用户取消🙁" sound name "Basso"'
              exit 0
          elif [ -z "$imageGRAVITY" ]; then
        imageGRAVITY=Center
          fi
      if [ "$imageGRAVITY" = "上" ]; then
        imageGRAVITY=North
        fi
      if [ "$imageGRAVITY" = "下" ]; then
        imageGRAVITY=South
        fi
      if [ "$imageGRAVITY" = "左" ]; then
        imageGRAVITY=West
        fi
      if [ "$imageGRAVITY" = "右" ]; then
        imageGRAVITY=East
        fi
      if [ "$imageGRAVITY" = "中心" ]; then
        imageGRAVITY=Center
        fi
      # 开始转换
      find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus aspect "$imageRESIZE" -m crop -g $imageGRAVITY {/} "{/.}_crop_$imageRESIZE.{+.}"
fi

if [ "$IMAGE_SET" = "aspect裁剪图片填充" ]; then
      # 获取原始图片尺寸
      imageSIZE="$(magick identify -ping -format "%wx%h\n" "$1" | tail -1)"
      # 输入修改尺寸
      imageRESIZE="$(osascript -e 'display dialog "设置图片尺寸:\t\t模式:填充\n\nWidthxHeight\t\t宽度x高度,指定所需的输出大小" default answer "'$imageSIZE'" with title "'"$version"'"' -e 'text returned of result' 2&gt;/dev/null)"
      # 若取消则退出，若留空则使用默认值
      if [ $? -ne 0 ]; then
            osascript -e 'display notification "已取消输入，若想转换图片请重新运行。" with title "用户取消🙁" sound name "Basso"'
              exit 0
          elif [ -z "$imageRESIZE" ]; then
        imageRESIZE="$imageSIZE"
          fi
      # 开始转换
      find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus aspect "$imageRESIZE" -m pad {/} "{/.}_pad_$imageRESIZE.{+.}"
fi

if [ "$IMAGE_SET" = "自动去背" ]; then
  # 开始转换格式
  COLOR_SET="$(magick "$1" -format "%[pixel:u.p{0,0}]" info:)"
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick {} -fuzz 20% -transparent "$COLOR_SET" "{.}_unmult.png"
fi

if [ "$IMAGE_SET" = "去除白色" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick {} -fuzz 20% -transparent white "{.}_unmult.png"
fi

if [ "$IMAGE_SET" = "color2alpha自动" ]; then
  # 开始转换格式
  COLOR_SET="$(magick "$1" -format "%[pixel:u.p{0,0}]" info:)"
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus color2alpha -ca "$COLOR_SET" {} "{.}_unmult.png"
fi

if [ "$IMAGE_SET" = "color2alpha去除白色" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus color2alpha -ca white {} "{.}_unmult.png"
fi

if [ "$IMAGE_SET" = "color2alpha去除黑色" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus color2alpha -ca black {} "{.}_unmult.png"
fi

if [ "$IMAGE_SET" = "color2alpha自定义" ]; then
  # 开始转换格式
  COLOR_SET="$(osascript -e 'display dialog "输入 RGB 颜色:" default answer "#ffffff" with title "color2alpha自定义"' -e 'text returned of result' 2&gt;/dev/null)"
  # 若取消则退出，若留空则使用默认值        
    if [ $? -ne 0 ]; then
          osascript -e 'display alert "已取消输入，若想转换请重新运行。" as warning'
            exit 0
        elif [ -z "$COLOR_SET" ]; then
      COLOR_SET="#ffffff"
        fi
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus color2alpha -ca '"$COLOR_SET"' {} "{.}_unmult.png"
fi

if [ "$IMAGE_SET" = "绿幕抠像" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus greenscreen -t 22 -a 2000 -s 0 -A 2 -b none {} "{.}_unmult.png"
fi

if [ "$IMAGE_SET" = "缩小文件大小" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus downsize -s 200 -t 1 -c yes {} "{.}_200k.{+.}"
fi

if [ "$IMAGE_SET" = "裁剪为矩形" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus innercrop -f 4 -m crop {} "{.}_innercrop.{+.}"
fi

if [ "$IMAGE_SET" = "裁剪并拉直" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus unrotate2 -f 15 -t inner -F 5 {} "{.}_unrotate2.{+.}"
fi

if [ "$IMAGE_SET" = "高斯模糊" ]; then
  # 开始转换格式
    BLUR_SET="$(osascript -e 'display dialog "输入模糊参数:" default answer "0x8" with title "高斯模糊"' -e 'text returned of result' 2&gt;/dev/null)"
  # 若取消则退出，若留空则使用默认值        
    if [ $? -ne 0 ]; then
          osascript -e 'display alert "已取消输入，若想转换请重新运行。" as warning'
            exit 0
        elif [ -z "$BLUR_SET" ]; then
      BLUR_SET="0x8"
        fi
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus magick {} -blur "$BLUR_SET" "{.}_blur.{+.}"
fi

if [ "$IMAGE_SET" = "水彩效果" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus watercolor -s 0 -e 5 -m 33 -c 0 {} "{.}_watercolor.{+.}"
fi

if [ "$IMAGE_SET" = "刺绣效果" ]; then
  # 开始转换格式
  find "$@" -maxdepth 0 | parallel --max-args 1 --load 90% --plus embroidery -n 8 -p crosshatch -t 2 {} "{.}_embroidery.{+.}"
fi

# 显示通知
osascript -e 'display notification "Imagemagick converter" with title "转换完成🎉" subtitle "'"$version"'" sound name "Glass"'
</string>
					<key>CheckedForUserDefaultShell</key>
					<true/>
					<key>inputMethod</key>
					<integer>1</integer>
					<key>shell</key>
					<string>/bin/bash</string>
					<key>source</key>
					<string></string>
				</dict>
				<key>BundleIdentifier</key>
				<string>com.apple.RunShellScript</string>
				<key>CFBundleVersion</key>
				<string>2.0.3</string>
				<key>CanShowSelectedItemsWhenRun</key>
				<false/>
				<key>CanShowWhenRun</key>
				<true/>
				<key>Category</key>
				<array>
					<string>AMCategoryUtilities</string>
				</array>
				<key>Class Name</key>
				<string>RunShellScriptAction</string>
				<key>Disabled</key>
				<false/>
				<key>IgnoresInput</key>
				<false/>
				<key>InputUUID</key>
				<string>3B7EFA1C-3CD0-49BA-BD0E-0E1C3BE09D48</string>
				<key>Keywords</key>
				<array>
					<string>Shell</string>
					<string>脚本</string>
					<string>命令</string>
					<string>运行</string>
					<string>Unix</string>
				</array>
				<key>OutputUUID</key>
				<string>2DEC895A-927C-4869-9740-493F9E6E4FB0</string>
				<key>ShowWhenRun</key>
				<false/>
				<key>UUID</key>
				<string>70AE5623-B12F-4B24-934F-4B2EEC99DA91</string>
				<key>UnlocalizedApplications</key>
				<array>
					<string>Automator</string>
				</array>
				<key>arguments</key>
				<dict>
					<key>0</key>
					<dict>
						<key>default value</key>
						<integer>0</integer>
						<key>name</key>
						<string>inputMethod</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>0</string>
					</dict>
					<key>1</key>
					<dict>
						<key>default value</key>
						<string></string>
						<key>name</key>
						<string>source</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>1</string>
					</dict>
					<key>2</key>
					<dict>
						<key>default value</key>
						<false/>
						<key>name</key>
						<string>CheckedForUserDefaultShell</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>2</string>
					</dict>
					<key>3</key>
					<dict>
						<key>default value</key>
						<string></string>
						<key>name</key>
						<string>COMMAND_STRING</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>3</string>
					</dict>
					<key>4</key>
					<dict>
						<key>default value</key>
						<string>/bin/sh</string>
						<key>name</key>
						<string>shell</string>
						<key>required</key>
						<string>0</string>
						<key>type</key>
						<string>0</string>
						<key>uuid</key>
						<string>4</string>
					</dict>
				</dict>
				<key>isViewVisible</key>
				<true/>
				<key>location</key>
				<string>374.500000:1286.000000</string>
				<key>nibPath</key>
				<string>/System/Library/Automator/Run Shell Script.action/Contents/Resources/Base.lproj/main.nib</string>
			</dict>
			<key>isViewVisible</key>
			<true/>
		</dict>
	</array>
	<key>connectors</key>
	<dict>
		<key>1B89A71C-525A-44C6-A4D7-DE30874CF59E</key>
		<dict>
			<key>from</key>
			<string>98C08AC0-5661-43FB-A783-4EDEEA4DEFE8 - 98C08AC0-5661-43FB-A783-4EDEEA4DEFE8</string>
			<key>to</key>
			<string>1B28246C-46B3-4668-80AB-C709673915C7 - 1B28246C-46B3-4668-80AB-C709673915C7</string>
		</dict>
		<key>475C5120-4D22-4E93-B315-C81E14BE6750</key>
		<dict>
			<key>from</key>
			<string>0C322224-079C-40B2-827A-697595EFD823 - 0C322224-079C-40B2-827A-697595EFD823</string>
			<key>to</key>
			<string>FD4028FE-A123-4593-AA98-94F10EAE37A3 - FD4028FE-A123-4593-AA98-94F10EAE37A3</string>
		</dict>
		<key>82A91EEB-49F8-4F53-B8AC-0EFAC37BAB88</key>
		<dict>
			<key>from</key>
			<string>FD4028FE-A123-4593-AA98-94F10EAE37A3 - FD4028FE-A123-4593-AA98-94F10EAE37A3</string>
			<key>to</key>
			<string>98C08AC0-5661-43FB-A783-4EDEEA4DEFE8 - 98C08AC0-5661-43FB-A783-4EDEEA4DEFE8</string>
		</dict>
		<key>E2A27E7A-42AE-45C2-B661-01331AF8EE90</key>
		<dict>
			<key>from</key>
			<string>1B28246C-46B3-4668-80AB-C709673915C7 - 1B28246C-46B3-4668-80AB-C709673915C7</string>
			<key>to</key>
			<string>70AE5623-B12F-4B24-934F-4B2EEC99DA91 - 70AE5623-B12F-4B24-934F-4B2EEC99DA91</string>
		</dict>
	</dict>
	<key>variables</key>
	<array>
		<dict>
			<key>UUID</key>
			<string>3829AC00-FCBA-4A4C-9207-F103344DE268</string>
			<key>identifier</key>
			<string>com.apple.Automator.Variable.Storage</string>
			<key>name</key>
			<string>Var1</string>
		</dict>
		<dict>
			<key>UUID</key>
			<string>E8B3E716-21E5-4CE5-8B4D-F7C45DD6DD1B</string>
			<key>identifier</key>
			<string>com.apple.Automator.Variable.Storage</string>
			<key>name</key>
			<string>Var2</string>
		</dict>
	</array>
	<key>workflowMetaData</key>
	<dict>
		<key>applicationBundleID</key>
		<string>com.apple.finder</string>
		<key>applicationBundleIDsByPath</key>
		<dict>
			<key>/System/Library/CoreServices/Finder.app</key>
			<string>com.apple.finder</string>
		</dict>
		<key>applicationPath</key>
		<string>/System/Library/CoreServices/Finder.app</string>
		<key>applicationPaths</key>
		<array>
			<string>/System/Library/CoreServices/Finder.app</string>
		</array>
		<key>inputTypeIdentifier</key>
		<string>com.apple.Automator.fileSystemObject.image</string>
		<key>outputTypeIdentifier</key>
		<string>com.apple.Automator.nothing</string>
		<key>presentationMode</key>
		<integer>15</integer>
		<key>processesInput</key>
		<integer>0</integer>
		<key>serviceApplicationBundleID</key>
		<string>com.apple.finder</string>
		<key>serviceApplicationPath</key>
		<string>/System/Library/CoreServices/Finder.app</string>
		<key>serviceInputTypeIdentifier</key>
		<string>com.apple.Automator.fileSystemObject.image</string>
		<key>serviceOutputTypeIdentifier</key>
		<string>com.apple.Automator.nothing</string>
		<key>serviceProcessesInput</key>
		<integer>0</integer>
		<key>systemImageName</key>
		<string>NSActionTemplate</string>
		<key>useAutomaticInputType</key>
		<integer>0</integer>
		<key>workflowTypeIdentifier</key>
		<string>com.apple.Automator.servicesMenu</string>
	</dict>
</dict>
</plist>
