#!/bin/bash
# è‹¥å‘½ä»¤å¤±è´¥è®©è„šæœ¬é€€å‡º 
set -o errexit
# è®¾ç½®çŽ¯å¢ƒå˜é‡
# PATH=$PATH:/usr/local/bin/
# å…ˆåŒæ­¥ä¸€æ¬¡
# åŒæ­¥"Services"æ–‡ä»¶å¤¹å†…å®¹åˆ°"æœåŠ¡",æŽ’é™¤ '_gsdata_' 'QuickLook' '*~.workflow'
rsync -cavu --delete --delete-excluded --exclude '_gsdata_' --exclude 'QuickLook' --exclude '*~.workflow' "/Users/Sengoku/Library/Services/" "/Users/Sengoku/Git/MacOS-Automator/æœåŠ¡"
# é€šçŸ¥
osascript -e 'display notification "Services ðŸ”œ Git æœåŠ¡å·²å¯åŠ¨!" with title "fswatch-rsync" sound name "Glass"'
# ç›‘è§†æ–‡ä»¶å¤¹å¹¶åŒæ­¥
/usr/local/bin/fswatch -0 -l 5 --event "Created" --event "Updated" --event "Removed" --event "Renamed" --event "OwnerModified" --event "MovedFrom" --event "MovedTo" -e "QuickLook" -e "*~.workflow" "/Users/Sengoku/Library/Services" | while read -d "" event; do 
	# åŒæ­¥"Services"æ–‡ä»¶å¤¹å†…å®¹åˆ°"æœåŠ¡",æŽ’é™¤ '_gsdata_' 'QuickLook' '*~.workflow'
	rsync -cavu --delete --delete-excluded --exclude '_gsdata_' --exclude 'QuickLook' --exclude '*~.workflow' "/Users/Sengoku/Library/Services/" "/Users/Sengoku/Git/MacOS-Automator/æœåŠ¡"
	osascript -e 'display notification "ðŸ”„'"${event}"'" with title "fswatch-rsync" sound name "Glass"'
	echo "${event} was rsynced" >> /Users/Sengoku/Git/MacOS-Automator/rsync.log 2>&1
done